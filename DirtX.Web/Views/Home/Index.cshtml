@model MotorcycleViewModel

@{
    ViewData["Title"] = "Motorcycle Selection";
}

<h2>Motorcycle Selection</h2>

<div class="form-group">
    <label asp-for="SelectedMake" class="control-label"></label>
    <select asp-for="SelectedMake" class="form-control" id="makeDropdown">
        <option value="">Select a Make</option>
        @foreach (var make in Model.Makes)
        {
            <option value="@make.Value">@make.Text</option>
        }
    </select>
</div>

<div class="form-group">
    <label asp-for="SelectedModel" class="control-label"></label>
    <select asp-for="SelectedModel" class="form-control" id="modelDropdown">
        <option value="">Select a Model</option>
    </select>
</div>

<div class="form-group">
    <label asp-for="SelectedDisplacement" class="control-label"></label>
    <select asp-for="SelectedDisplacement" class="form-control" id="displacementDropdown">
        <option value="">Select a Displacement</option>
    </select>
</div>

<div class="form-group">
    <label asp-for="SelectedYear" class="control-label"></label>
    <select asp-for="SelectedYear" class="form-control" id="yearDropdown">
        <option value="">Select a Year</option>
    </select>
</div>



@section scripts {
    <script>
        $(document).ready(function () {
            $('#makeDropdown').change(function () {
                var selectedMake = $(this).val();
                var modelDropdown = $('#modelDropdown');
                modelDropdown.empty();
                modelDropdown.append($('<option></option>').attr('value', '').text('Select a Model'));

                var displacementDropdown = $('#displacementDropdown');
                displacementDropdown.empty();
                displacementDropdown.append($('<option></option>').attr('value', '').text('Select a Displacement'));

                var yearDropdown = $('#yearDropdown');
                yearDropdown.empty();
                yearDropdown.append($('<option></option>').attr('value', '').text('Select a Year'));

                $.getJSON('@Url.Action("GetMotorcycle", "Home")', { make: selectedMake }, function (models) {
                    $.each(models, function (index, model) {
                        modelDropdown.append($('<option></option>').attr('value', model.value).text(model.text));
                    });
                });
            });

            $('#modelDropdown').change(function () {
                var selectedMake = $('#makeDropdown').val();
                var selectedModel = $(this).val();
                var displacementDropdown = $('#displacementDropdown');
                displacementDropdown.empty();
                displacementDropdown.append($('<option></option>').attr('value', '').text('Select a Displacement'));

                $.getJSON('@Url.Action("GetDisplacement", "Home")', { make: selectedMake, model: selectedModel }, function (displacements) {
                    $.each(displacements, function (index, displacement) {
                        displacementDropdown.append($('<option></option>').attr('value', displacement.value).text(displacement.text));
                    });
                });
            });

            $('#displacementDropdown').change(function () {
                var selectedMake = $('#makeDropdown').val();
                var selectedModel = $('#modelDropdown').val();
                var selectedDisplacement = $(this).val();
                var yearDropdown = $('#yearDropdown');
                yearDropdown.empty();
                yearDropdown.append($('<option></option>').attr('value', '').text('Select a Year'));

                $.getJSON('@Url.Action("GetYear", "Home")', { make: selectedMake, model: selectedModel, displacement: selectedDisplacement }, function (years) {
                    $.each(years, function (index, year) {
                        yearDropdown.append($('<option></option>').attr('value', year.value).text(year.text));
                    });
                });
            });
        });
    </script>
}
